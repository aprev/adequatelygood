(function(d){var c;var i;var g;var m="/";var a="_tmpl_postDialog";var e=function(t,v,s){var u={"400":"Uh oh!  I couldn't save your post.  Seriously, I have no idea what went wrong.",};if(!(t.status in u)){u[t.status]="Ooops!  There was a mysterious error of some kind.  Sorry about that!  ("+t.status+" - "+t.statusText+")"}g.errorText.text(u[t.status]);g.error.show()};var p=function(s){consul.log("submission complete, response: "+s);window.location.href=s};var o={cache:false,dataType:"text",error:e,success:p,type:"POST"};var n=function(){i=d("<div/>");g=i.tmpl(a,{});i.dialog(c);var u=function(){i.dialog("open")};switch(d(this).attr("id")){case"newarticle":m="/";l("","","");break;case"newblog":var s=new Date();var v=s.getMonth()+1;var t=s.getFullYear();m="/"+t+"/"+v;l("","","");break;case"editbtn":m="?_method=PUT";d.getJSON(window.location.href,{},function(w){l(w.body,w.title,w.tags);u()});return}u()};var l=function(s,u,t){if(s===undefined){s=""}d(g.postBody).val(s);if(u!==undefined){d(g.postTitle).val(u)}if(t!==undefined){if(t.constructor==Array){t=t.join(", ")}d(g.postTags).val(t)}};var b=function(){var s=d(g.postBody).val();var v=d(g.postTitle).val();var u=d(g.postTags).val();g.error.hide();consul.log("beginning submission");var t=o;t.url=m;t.data={body:s,title:v,tags:u};d.ajax(t)};var r=function(){i.dialog("destroy");delete i;delete g};var k=function(){i.dialog("close");r()};var h=function(s,t){r();consul.log("dialog closed")};var q=function(s,t){consul.log("dialog opened")};c={autoOpen:false,modal:true,title:"an adequately good post editor",width:800,close:h,open:q,buttons:{post:b,cancel:k}};var j=function(){d.ajax({type:"DELETE",url:"#",success:function(s){window.location.href=s},dataType:"text"})};var f=function(){d("<div/>").text("Are you sure you want to delete this entry?").dialog({modal:true,title:"confirm deletion",buttons:{"delete it":j,cancel:function(){d(this).dialog("destroy")}}})};d(function(){d("#newblog, #newarticle, #editbtn").live("click",n);d("#deletebtn").live("click",f)})})(jQuery);